# Instrukce pro Cursor AI - HACCP Audit Assistant

## ğŸ¯ ZÃKLADNÃ PRAVIDLA

### VÅ¾dy pracuj podle dokumentace
- **Flowbite dokumentace je tvÅ¯j "svatÃ½ grÃ¡l"**: https://flowbite-react.com/
- **Firebase dokumentace**: https://firebase.google.com/docs
- Pokud nÄ›co nevÃ­Å¡, vÅ¾dy nejdÅ™Ã­v zkontroluj dokumentaci
- Pokud nedokÃ¡Å¾eÅ¡ nÄ›co vyÅ™eÅ¡it, napiÅ¡ uÅ¾ivateli kde to najde nebo jak na to

### âš ï¸ AUTOMATICKÃ AKTUALIZACE DOKUMENTACE
- **KdyÅ¾ se mÄ›nÃ­ nÄ›co zÃ¡sadnÃ­ho v projektu, VÅ½DY automaticky aktualizuj relevantnÃ­ dokumenty:**
  - PÅ™idÃ¡nÃ­ novÃ© technologie â†’ aktualizuj `.cursorrules` sekci "Technologie projektu"
  - ZmÄ›na struktury projektu â†’ aktualizuj `.cursorrules` sekci "Struktura projektu"
  - PÅ™idÃ¡nÃ­ novÃ© Firebase sluÅ¾by â†’ aktualizuj `.cursorrules` sekci "Firebase pravidla"
  - ZmÄ›na UI frameworku nebo pravidel â†’ aktualizuj `.cursorrules` a `FLOWBITE_PRIRUCKA.md`
  - PÅ™idÃ¡nÃ­ novÃ©ho dÅ¯leÅ¾itÃ©ho souboru â†’ aktualizuj `.cursorrules` sekci "DÅ¯leÅ¾itÃ© soubory"
- **NepoÄÃ­tej s tÃ­m, Å¾e uÅ¾ivatel si to aktualizuje sÃ¡m - vÅ¾dy to udÄ›lej automaticky!**
- **Aktualizace dokumentace je souÄÃ¡stÃ­ zmÄ›ny, ne samostatnÃ½ krok**

### Technologie projektu
- **Frontend**: React 19.2.0 + TypeScript + Vite
- **UI Framework**: Flowbite React (vÅ¾dy pouÅ¾Ã­vej podle dokumentace!)
- **CSS Framework**: Tailwind CSS v3.4.18 (integrovanÃ½ s Flowbite)
- **Backend**: Firebase (Firestore, Storage, Functions, Authentication)
- **Build**: Vite
- **State Management**: React Hooks + Context API

---

## ğŸ¨ UI PRAVIDLA - FLOWBITE

### âš ï¸ KRITICKÃ‰ PRAVIDLA PRO UI ZMÄšNY:

1. **VÅ½DY pouÅ¾Ã­vej Flowbite komponenty** podle oficiÃ¡lnÃ­ dokumentace
   - Odkaz: https://flowbite-react.com/
   - PÅ™ed kaÅ¾dou zmÄ›nou UI zkontroluj dokumentaci Flowbite

2. **Light mode ONLY** - aplikace je vÅ¾dy v light mode
   - `class="light"` na `<html>` tagu
   - NIKDY nepouÅ¾Ã­vej `dark:` tÅ™Ã­dy
   - NIKDY nepouÅ¾Ã­vej dark mode styling

3. **ZachovÃ¡nÃ­ pÅ¯vodnÃ­ch barev**
   - Pro gradienty: VÅ½DY pouÅ¾Ã­vej inline styles `style={{ background: 'linear-gradient(...)' }}`
   - NIKDY nepouÅ¾Ã­vej Tailwind gradient tÅ™Ã­dy pro barvy (`bg-gradient-to-r`, atd.)
   - Barvy z `constants/designSystem.ts` - SECTION_THEMES

4. **Wrapper komponenty**
   - ExistujÃ­cÃ­ wrappery v `components/ui/` zachovÃ¡vajÃ­ API
   - PouÅ¾Ã­vajÃ­ Flowbite komponenty uvnitÅ™
   - Pokud vytvÃ¡Å™Ã­Å¡ novou komponentu, pouÅ¾ij Flowbite pÅ™Ã­mo, ne wrapper

5. **Icon props**
   - Flowbite vyÅ¾aduje ikony jako funkce: `icon={() => <Icon />}`
   - NIKDY nepouÅ¾Ã­vej: `icon={<Icon />}`

### âœ… Co VÅ½DY dÄ›lat pÅ™i zmÄ›nÃ¡ch UI:

```tsx
// âœ… SPRÃVNÄš - Flowbite podle dokumentace
import { Button } from 'flowbite-react';
<Button color="blue" size="md">Text</Button>

// âœ… SPRÃVNÄš - Gradient pÅ™es inline style
<div style={{
  background: `linear-gradient(to right, ${theme.colors.primary}, ${theme.colors.darkest})`
}}>

// âœ… SPRÃVNÄš - Icon jako funkce
<TextInput icon={() => <SearchIcon />} />
```

### âŒ Co NIKDY nedÄ›lat:

```tsx
// âŒ Å PATNÄš - custom CSS mÃ­sto Flowbite
<button className="px-4 py-2 bg-blue-500">Text</button>

// âŒ Å PATNÄš - Tailwind gradient tÅ™Ã­dy
<div className="bg-gradient-to-r from-blue-500 to-purple-500">

// âŒ Å PATNÄš - dark mode
<div className="bg-white dark:bg-gray-800">

// âŒ Å PATNÄš - icon jako JSX
<TextInput icon={<SearchIcon />} />
```

### ğŸ“š Flowbite dokumentace odkazy:
- **HlavnÃ­**: https://flowbite-react.com/
- **Komponenty**: https://flowbite-react.com/docs/components/button
- **Theme**: https://flowbite-react.com/docs/customize/theme

### ğŸ“ PrÅ¯vodce Flowbite najdeÅ¡ v:
- `FLOWBITE_PRIRUCKA.md` - detailnÃ­ pÅ™Ã­ruÄka pro Flowbite v projektu

---

## ğŸ”¥ FIREBASE PRAVIDLA

### Struktura Firebase sluÅ¾eb:

1. **Firebase Authentication**
   - `contexts/AuthContext.tsx` - wrapper pro Firebase Auth
   - `components/LoginScreen.tsx`, `components/RegisterScreen.tsx`
   - UÅ¾ivatelÃ© jsou izolovÃ¡ni podle `uid`

2. **Firestore Database**
   - VÅ¡echny CRUD operace v `services/firestore/`
   - Collections: `customers`, `audits`, `reports`, `settings`, `users`, `aiUsageLogs`
   - **Security Rules**: `firestore.rules` - user isolation

3. **Firebase Storage**
   - `services/storage.ts` - upload/download fotek
   - Fotky auditÅ¯: `audits/{auditId}/photos/{photoId}`
   - PDF reporty: `reports/{reportId}/pdf`
   - **Security Rules**: `storage.rules` - max 10MB pro obrÃ¡zky

4. **Cloud Functions**
   - `functions/src/` - serverless funkce
   - `generateReport.ts`, `transcribeAudio.ts`, `generatePdf.ts`, `analyzeImage.ts`

### âœ… Co VÅ½DY dÄ›lat pÅ™i prÃ¡ci s Firebase:

```tsx
// âœ… SPRÃVNÄš - pouÅ¾ij existujÃ­cÃ­ service funkce
import { createAudit, updateAudit } from './services/firestore';
await createAudit(auditData);

// âœ… SPRÃVNÄš - pouÅ¾ij AuthContext pro uÅ¾ivatele
import { useAuth } from './contexts/AuthContext';
const { user } = useAuth();

// âœ… SPRÃVNÄš - error handling
try {
  await someFirebaseOperation();
} catch (error) {
  toast.error('Chyba: ' + error.message);
}
```

### âŒ Co NIKDY nedÄ›lat:

```tsx
// âŒ Å PATNÄš - pÅ™Ã­mÃ½ import Firebase SDK v komponentÃ¡ch
import { collection, addDoc } from 'firebase/firestore';
// PouÅ¾Ã­vej service funkce mÃ­sto toho!

// âŒ Å PATNÄš - ignorovÃ¡nÃ­ error handlingu
await createAudit(data); // Co kdyÅ¾ selÅ¾e?
```

### ğŸ“š Firebase dokumentace:
- **Firestore**: https://firebase.google.com/docs/firestore
- **Storage**: https://firebase.google.com/docs/storage
- **Functions**: https://firebase.google.com/docs/functions
- **Auth**: https://firebase.google.com/docs/auth

### ğŸ“ PrÅ¯vodce Firebase najdeÅ¡ v:
- `NAVOD.md` - kompletnÃ­ nÃ¡vod k nastavenÃ­ a deploy
- `README.md` - struktura projektu a Firebase migrace

---

## ğŸ“ STRUKTURA PROJEKTU

### HlavnÃ­ adresÃ¡Å™e:

```
HACCP1/
â”œâ”€â”€ components/          # React komponenty
â”‚   â”œâ”€â”€ ui/              # Flowbite wrapper komponenty (Button, Card, Input, Modal)
â”‚   â”œâ”€â”€ icons/           # SVG ikony
â”‚   â””â”€â”€ [screens].tsx    # Obrazovky aplikace
â”‚
â”œâ”€â”€ services/            # Business logika a API
â”‚   â”œâ”€â”€ firestore/       # Firestore CRUD operace
â”‚   â””â”€â”€ storage.ts       # Firebase Storage
â”‚
â”œâ”€â”€ contexts/            # React Contexts
â”‚   â””â”€â”€ AuthContext.tsx  # Firebase Authentication
â”‚
â”œâ”€â”€ hooks/               # Custom React hooks
â”‚   â”œâ”€â”€ useAppData.ts    # NaÄÃ­tÃ¡nÃ­ dat z Firestore
â”‚   â””â”€â”€ useUserRole.ts
â”‚
â”œâ”€â”€ types.ts             # TypeScript typy
â”œâ”€â”€ constants/designSystem.ts  # Design systÃ©m (SECTION_THEMES)
â”‚
â”œâ”€â”€ firebaseConfig.ts    # Firebase inicializace
â”œâ”€â”€ firestore.rules      # Firestore security rules
â”œâ”€â”€ storage.rules        # Storage security rules
â”‚
â””â”€â”€ functions/src/       # Cloud Functions
```

### DÅ¯leÅ¾itÃ© soubory:

- **`App.tsx`** - hlavnÃ­ logika aplikace, routing
- **`AppWithAuth.tsx`** - wrapper s autentifikacÃ­
- **`firebaseConfig.ts`** - Firebase SDK inicializace
- **`FLOWBITE_PRIRUCKA.md`** - Flowbite pÅ™Ã­ruÄka
- **`NAVOD.md`** - nÃ¡vod k nastavenÃ­ a deploy

---

## ğŸ”§ WORKFLOW PRO ZMÄšNY

### PÅ™i zmÄ›nÄ› UI komponenty:

1. **Zkontroluj Flowbite dokumentaci** - https://flowbite-react.com/
2. **PodÃ­vej se do `FLOWBITE_PRIRUCKA.md`** - mÃ¡Å¡ tam pÅ™Ã­klady
3. **PouÅ¾ij Flowbite komponentu** podle dokumentace
4. **Zachovej pÅ¯vodnÃ­ barvy** pÅ™es inline styles
5. **Otestuj v light mode** - aplikace je vÅ¾dy svÄ›tlÃ¡

### PÅ™i prÃ¡ci s Firebase:

1. **Zkontroluj existujÃ­cÃ­ service funkce** v `services/firestore/`
2. **PouÅ¾ij existujÃ­cÃ­ funkce** mÃ­sto pÅ™Ã­mÃ©ho Firebase SDK
3. **Respektuj security rules** - uÅ¾ivatelÃ© jsou izolovÃ¡ni
4. **PÅ™idej error handling** - vÅ¡echny operace mohou selhat

---

## âœ… CHECKLIST PÅ˜ED COMMITEM

### UI zmÄ›ny:
- [ ] PouÅ¾il jsem Flowbite komponentu podle dokumentace?
- [ ] Zachoval jsem pÅ¯vodnÃ­ barvy pÅ™es inline styles?
- [ ] Komponenta funguje v light mode?
- [ ] NenÃ­ tam Å¾Ã¡dnÃ½ dark mode CSS?
- [ ] **Aktualizoval jsem dokumentaci pokud byla zmÄ›na zÃ¡sadnÃ­?**

### Firebase zmÄ›ny:
- [ ] PouÅ¾il jsem existujÃ­cÃ­ service funkce?
- [ ] PÅ™idal jsem error handling?
- [ ] Security rules jsou sprÃ¡vnÄ› nastavenÃ©?
- [ ] **Aktualizoval jsem dokumentaci pokud byla zmÄ›na zÃ¡sadnÃ­?**

### ObecnÃ©:
- [ ] KÃ³d je TypeScript validnÃ­?
- [ ] Build prochÃ¡zÃ­ (`npm run build`)?
- [ ] **Aktualizoval jsem `.cursorrules` nebo jinou dokumentaci pokud byla zmÄ›na zÃ¡sadnÃ­?**

---

## ğŸš¨ ÄŒASTÃ‰ CHYBY

1. **NepouÅ¾itÃ­ Flowbite dokumentace** - VÅ½DY zkontroluj https://flowbite-react.com/
2. **Dark mode tÅ™Ã­dy** - Aplikace je vÅ¾dy svÄ›tlÃ¡, nepouÅ¾Ã­vej dark mode
3. **Tailwind gradienty mÃ­sto inline styles** - PouÅ¾Ã­vej inline styles pro gradienty
4. **PÅ™Ã­mÃ½ Firebase SDK v komponentÃ¡ch** - PouÅ¾Ã­vej service funkce z `services/firestore/`
5. **Icon jako JSX mÃ­sto funkce** - Flowbite vyÅ¾aduje `icon={() => <Icon />}`

---

## ğŸ“š DÅ®LEÅ½ITÃ‰ ODKAZY

### Dokumentace:
- **Flowbite React**: https://flowbite-react.com/
- **Firebase**: https://firebase.google.com/docs

### ProjektovÃ© soubory:
- **Flowbite pÅ™Ã­ruÄka**: `FLOWBITE_PRIRUCKA.md`
- **Firebase nÃ¡vod**: `NAVOD.md`
- **README**: `README.md`

---

## âš ï¸ POKUD NÄšCO NEVÃÅ 

1. **Zkontroluj dokumentaci** - Flowbite nebo Firebase
2. **PodÃ­vej se do projektovÃ½ch souborÅ¯** - `FLOWBITE_PRIRUCKA.md`, `NAVOD.md`
3. **Zkontroluj podobnÃ½ kÃ³d** v projektu - jak se to dÄ›lÃ¡ jinde
4. **Pokud nedokÃ¡Å¾eÅ¡ vyÅ™eÅ¡it** - napiÅ¡ uÅ¾ivateli konkrÃ©tnÄ› kde to najde nebo jak na to

---

**PAMATUJ SI: Dokumentace je tvÅ¯j nejlepÅ¡Ã­ pÅ™Ã­tel - vÅ¾dy ji kontroluj pÅ™ed psanÃ­m kÃ³du!**
